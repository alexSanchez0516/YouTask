function deletePost(){$(document).on("click","#delete_post",e=>{if(confirm("¿Seguro que quieres eliminar este post?")){let t=e.target.dataset.id;$.post("http://127.0.0.1:8080/api/post/delete",{id_element:t},e=>{listPosts()})}})}function update_post(){$(document).on("click","#update_post",e=>{let t=e.target.dataset.id;window.location.href="http://127.0.0.1:8080/modificar-post?id="+t,console.log(t)})}function deleteFriend(){$(document).on("click",".delete_friend",e=>{if(confirm("¿Estas seguro que quieres eliminar este amigo?")){let t=e.target.parentElement.parentElement.children[2].textContent;$.post("http://127.0.0.1:8080/api/friends/delete",{id_element:t},e=>{showFriends()})}})}function close_activity_perfil(){const e=document.querySelector("#close_activity_perfil"),t=document.querySelectorAll(".activity_perfil");null!=e&&e.addEventListener("click",(function(){t.forEach(t=>{t.classList.toggle("d-none"),t.classList.contains("d-none")?e.textContent="mostrar":e.textContent="ocultar"})}))}async function showFriends(){window.location.pathname;try{const e="http://127.0.0.1:8080/api/friends",t=await fetch(e),n=await t.json();createFriendsList(n[1],n[0])}catch(e){console.log(e)}}function copyToClipboard(){const e=document.querySelector(".share");let t=e.dataset.text;e.addEventListener("click",()=>{navigator.clipboard.writeText(t).then(()=>{alert("Copiado correctamente")})})}async function listPosts(){let e=window.location.pathname;if("/posts"==e||"/perfil"==e)try{const e="http://127.0.0.1:8080/api/posts",t=await fetch(e),n=await t.json(),o=document.querySelector("#wrap-articles");template="",n.length>0?n.forEach(e=>{let t="https://www.youtask.es/post?id="+e.id;template+=`\n                    <article class="wrap-article m-2 d-flex flex-column">\n                        \n                        <div class="align-self-end">\n                            <button id="update_post" data-id="${e.id}" type="button" class="btn  my-2 btn-primary text-right text-end  " >Modificar</button>\n                            <button id="delete_post" data-id="${e.id}" type="button" class="btn  my-2 btn-danger text-right text-end" >Eliminar</button>\n                            \n                        </div>\n                        \n                        \n                        <span class="text-right d-block w-100 text-end">${e.create_at}</span>\n                        <h3><a class="text-decoration-none text-dark text-capitalize" href="/post?id=${e.id}">${e.name}</a></h3>\n                        <p>\n                            ${e.content.substring(0,500)}\n\n\n                            <a  href="/post?id=${e.id}"><svg class="mx-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal icon-lg text-muted pb-3px">\n                                    <circle cx="12" cy="12" r="1"></circle>\n                                    <circle cx="19" cy="12" r="1"></circle>\n                                    <circle cx="5" cy="12" r="1"></circle>\n                                </svg></a>\n                            </span>\n                        </p>\n                        <div>\n                            <div class="d-flex post-actions">\n                                <a href="javascript:;" class="d-flex mx-2 align-items-center text-muted mr-4">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-heart icon-md">\n                                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>\n                                    </svg><span class="text-dark fs-5">(${e.likes})</span>\n                                    <p class="d-none d-md-block mx-2"></p>\n                                </a>\n                                <a href="javascript:;" class="d-flex mx-2 align-items-center text-muted mr-4">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square icon-md">\n                                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>\n                                    </svg>\n                                    <p class="d-none d-md-block mx-2"></p>\n                                </a>\n                                <a href="javascript:;" class="d-flex mx-2 align-items-center text-muted">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share icon-md">\n                                        <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>\n                                        <polyline points="16 6 12 2 8 6"></polyline>\n                                        <line x1="12" y1="2" x2="12" y2="15"></line>\n                                    </svg>\n                                    <p class="d-none share d-md-block ml-2" data-text="${t}" onclick="copyToClipboard();">Compartir</p>\n                                </a>\n                            </div>\n                        </div>\n                    </article>\n                    <hr/>\n                    `}):template="<div><span>No hay artículos</span></div>","/perfil"===location.pathname&&(template+=' \n                <div class="d-flex justify-content-center mt-5">\n                    <button class="btn btn-secondary" onclick="window.location.href=\'/posts\'">Ver más</button>\n                </div>\n                '),o.innerHTML=template}catch(e){console.log(e)}}function createFriendsList(e,t){const n=document.querySelector("#container_friends")??0;(document.querySelector("#countFriends")??0).textContent="Lista de amigos ("+t+")";let o="";e.length>0?e.forEach(e=>{o+=`\n            <div class="col-12 col-md-5 border shadow m-2">\n                <div class="row">\n                    <div class="col-3" id="">\n                        <img id="avatar" src="/build/img/${e.avatar}" alt="avatar" srcset="" class="img-fluid m-2">\n                    </div>\n                    <div class="col-4 d-flex justify-content-center align-items-center">\n                        <span id="friend_username">${e.username}</span>\n                    </div>\n                    <div class="col-5 d-flex">\n                        <nav class="navbar navbar-expand-sm">\n                            <ul class="navbar-nav">\n                                <li class="nav-item dropdown">\n                                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">\n                                        Acciones\n                                    </a>\n                                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">\n                                        <li><a class="dropdown-item" href="/amigo?id=${e.id}">Ver Perfil</a></li>\n                                        <li><a class="dropdown-item delete_friend" href="#">Eliminar</a></li>\n                                        <li class="d-none">${e.id}</li>\n                                        <li>\n                                            <hr class="dropdown-divider">\n                                        </li>\n                                        <li><a class="dropdown-item" href="#">Enviar mensaje</a></li>\n                                    </ul>\n                                </li>\n                            </ul>\n                        </nav>\n                    </div>\n                </div>\n            </div>\n            `}):o='<p class="text-center text-danger">No tienes amigos agregados</p>',n.innerHTML=o}function showCreateProject(){const e=document.querySelector("#create_project"),t=document.querySelector("#wrap_initials"),n=document.querySelector("#wrap_create_project");null!=document.querySelector("#create_project")?null!=e?e.addEventListener("click",()=>{t.remove(),n.classList.add("show_wrap_create_project")}):n.classList.add("show_wrap_create_project"):null!=document.querySelector("#wrap_create_project")&&n.classList.add("show_wrap_create_project")}function checkPassword(){const e=document.querySelector("#password"),t=document.querySelector("#repeatPassword"),n=document.querySelector("#btn-register"),o=document.querySelector("#privacity");null!=o&&o.addEventListener("change",(function(){o.checked&&e.value==t.value&&n.classList.toggle("d-flex")}))}function checkAlerts(){if(document.querySelectorAll(".alerts")){document.querySelectorAll(".alerts").forEach(e=>{setTimeout(()=>{e.remove()},6e3)})}}function showMenuResponse(){const e=document.querySelector(".fa-bars"),t=document.querySelector(".nav__menu"),n=document.querySelector(".nav__list");null!=e&&e.addEventListener("click",()=>{t.classList.toggle("d-flex"),n.classList.toggle("flex-column")})}document.addEventListener("DOMContentLoaded",(function(){checkPassword(),checkAlerts(),showMenuResponse(),showCreateProject(),close_activity_perfil(),showFriends(),deleteFriend(),listPosts(),deletePost(),update_post()}));